@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@model VLUTUTORS.Models.Taikhoannguoidung
@{
    ViewData["Title"] = "Chi tiết tài khoản";
    Layout = "~/Areas/Tutors/Views/Shared/_TutorsLayout.cshtml";
}

<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <ol class="breadcrumb float-sm-right">
                    <li class="breadcrumb-item"><a href="~/Tutors">Home</a></li>
                    <li class="breadcrumb-item active">Thông Tin Tài Khoản</li>
                </ol>
            </div>
        </div>
        <!-- /.container-fluid -->
    </section>

    <!-- Main content -->
    <section class="content">
        <div class="container" style="margin-top: 20px; margin-bottom: 20px">
            <div class="main-body">
                <form method="post" enctype="multipart/form-data" asp-controller="Account" asp-action="Index">
                    @Html.AntiForgeryToken()
                    @Html.HiddenFor(m => m.Id)
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                    <div class="row gutters-sm">
                        <div class="col-md-4 mb-3 center-card">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex flex-column align-items-center text-center">
                                        @foreach (var file in Newtonsoft.Json.JsonConvert.DeserializeObject<List<string>>(Model.AnhDaiDien))
                                        {
                                            <img src="~/@file"
                                             id="preview"
                                             alt="Admin"
                                             class="rounded-circle"
                                             width="150" />
                                        }
                                        <div class="mt-3">
                                            <input style="width: 80px"
                                                   type="file"
                                                   name="avatar"
                                                   multiple="multiple"
                                                   accept=".jpg, .jpeg, .png" 
                                                   onchange="document.getElementById('preview').src= window.URL.createObjectURL(this.files[0])" /><br />
                                            <span>Định dạng: .JPG, .JPEG, .PNG</span>
                                        </div>
                                        <div class="mt-3">
                                            <h3>@Html.DisplayFor(m => m.HoTen, new { @readonly = true })</h3>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="card mb-3">
                                <div class="card-body">
                                    @Html.HiddenFor(m => m.Id)
                                    @Html.HiddenFor(m => m.HoTen)
                                    @Html.HiddenFor(m => m.MatKhau)
                                    @Html.HiddenFor(m => m.Idkhoa)
                                    @Html.HiddenFor(m => m.ChungChiMon1)
                                    @Html.HiddenFor(m => m.ChungChiMon2)
                                    @Html.HiddenFor(m => m.IdmonGiaSu1)
                                    @Html.HiddenFor(m => m.IdmonGiaSu2)
                                    @Html.HiddenFor(m => m.DiemBaiTest)
                                    @Html.HiddenFor(m => m.TrangThaiGiaSu)
                                    @Html.HiddenFor(m => m.Email)
                                    @Html.HiddenFor(m => m.NgaySinh)
                                    @Html.HiddenFor(m => m.IdgioiTinh)
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Email</h6>
                                        </div>
                                        <div class="col-sm-9 text-secondary">
                                            @Html.TextBoxFor(m => m.Email, new { @readonly = true })
                                        </div>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Khoa</h6>
                                        </div>
                                        @Html.DropDownListFor(m => m.Idkhoa, Model.DepartmentItems, new {@class = "form-control select-region", disabled = "disabled" })
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Ngày sinh</h6>
                                        </div>

                                        @Html.TextBoxFor(m => m.NgaySinh, "{0:dd/MM/yyyy}", new { @readonly = true })
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Giới tính</h6>
                                        </div>
                                        @Html.DropDownListFor(m => m.IdgioiTinh, Model.GenderItems, new { @class = "form-control select-region",disabled = "disabled"  })
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Số Điện Thoại</h6>
                                        </div>
                                        <input class="ip-form" name="Sdt"
                                               id="Sdt"
                                               type="tel"
                                               value="@Model.Sdt"
                                               data-error="Vui lòng điền đủ thông tin."
                                               required="required" />
                                    </div>
                                    <div class="message-error">
                                        <span asp-validation-for="Sdt" class="text-danger" style="color:red"></span>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Số tài khoản</h6>
                                        </div>
                                        <input class="ip-form" name="SoTaiKhoan"
                                               id="SoTaiKhoan"
                                               type="text"
                                               value="@Model.SoTaiKhoan"
                                               data-error="Vui lòng điền đủ thông tin."
                                               required="required" />
                                    </div>
                                    <div class="message-error">
                                        <span asp-validation-for="SoTaiKhoan" class="text-danger" style="color:red"></span>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Tên ngân hàng</h6>
                                        </div>
                                        @Html.DropDownListFor(m => m.IdnganHang, Model.BankItems, new { @class = "form-control select-region" })
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Điểm trung bình tích lũy</h6>
                                        </div>
                                        <input class="ip-form" name="DiemTrungBinh"
                                               id="DiemTrungBinh"
                                               type="text"
                                               value="@Model.DiemTrungBinh"
                                               data-error="Vui lòng điền đủ thông tin."
                                               required="required" />
                                    </div>
                                    <div class="message-error">
                                        <span asp-validation-for="DiemTrungBinh" class="text-danger" style="color:red"></span>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Giới thiệu bản thân</h6>
                                        </div>
                                        @Html.TextAreaFor(m => m.GioiThieu, new { htmlAttributes = new { @class = "ip-form", @required = "required", @id="GioiThieu", @name="GioiThieu" } })
                                    </div>
                                    <div class="message-error">
                                        <span asp-validation-for="GioiThieu" class="text-danger" style="color:red"></span>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">
                                                Giới thiệu bản thân về việc gia sư
                                            </h6>
                                        </div>
                                        @Html.TextAreaFor(m => m.DanhGiaVeViecGiaSu, new { htmlAttributes = new { @class = "ip-form", @required = "required", @id="DanhGiaVeViecGiaSu", @name="DanhGiaVeViecGiaSu" } })
                                    </div>
                                    <div class="message-error">
                                        <span asp-validation-for="DanhGiaVeViecGiaSu" class="text-danger" style="color:red"></span>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <h4>Môn gia sư thứ 1:</h4>
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Môn gia sư</h6>
                                        </div>
                                        @Html.DropDownListFor(m => m.IdmonGiaSu1, Model.Subject1Items, new { disabled = "disabled" })
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Tên chứng chỉ/Điểm trung bình môn</h6>
                                        </div>
                                        @Html.TextBoxFor(m => m.TenChungChiHoacDiemMon1)
                                    </div>
                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Minh chứng</h6>
                                        </div>
                                        @foreach (var file in Newtonsoft.Json.JsonConvert.DeserializeObject<List<string>>(Model.ChungChiMon1))
                                        {
                                            <p style="padding-left:2.00em;">@Html.ActionLink(file + " ", "DownloadFile", new { fileName = file, id = 1 })</p>

                                            <br />
                                            // id 1 representation for certificate 1
                                        }
                                    </div>
                                    <div class="row-nowrap">
                                        <input class=""
                                               type="file"
                                               name="certificates1"
                                               placeholder="Chứng Chỉ"
                                               multiple="multiple"
                                               accept=".jpg, .jpeg, .png, .doc, .docx, .pdf" />
                                    </div>

                                    <hr />
                                    <div class="row-nowrap">
                                        <div class="col-sm-3">
                                            <h6 class="mb-0">Giới thiệu về môn gia sư</h6>
                                        </div>
                                        @Html.TextAreaFor(m => m.GioiThieuVeMonGiaSu1, new { htmlAttributes = new { @class = "ip-form", @required = "required", @id="GioiThieuVeMonGiaSu1", @name="GioiThieuVeMonGiaSu1" } })
                                    </div>
                                    <div class="message-error">
                                        <span asp-validation-for="GioiThieuVeMonGiaSu1" class="text-danger" style="color:red"></span>
                                    </div>
                                    <hr />
                                    @if (Model.IdmonGiaSu2 != null)
                                    {
                                        <div class="row-nowrap">
                                            <h4>Môn gia sư thứ 2:</h4>
                                        </div>
                                        <hr />
                                        <div class="row-nowrap">
                                            <div class="col-sm-3">
                                                <h6 class="mb-0">Môn gia sư</h6>
                                            </div>
                                            @Html.DropDownListFor(m => m.IdmonGiaSu2, Model.Subject2Items, new { disabled = "disabled" })
                                        </div>
                                        <hr />
                                        <div class="row-nowrap">
                                            <div class="col-sm-3">
                                                <h6 class="mb-0">Tên chứng chỉ/Điểm trung bình môn</h6>
                                            </div>
                                            @Html.TextBoxFor(m => m.TenChungChiHoacDiemMon2)
                                        </div>

                                        <hr />
                                        <div class="row-nowrap">
                                            <div class="col-sm-3">
                                                <h6 class="mb-0">Ảnh minh chứng</h6>
                                            </div>
                                            @foreach (var file in Newtonsoft.Json.JsonConvert.DeserializeObject<List<string>>(Model.ChungChiMon2))
                                            {
                                                <p style="padding-left:2.00em;">@Html.ActionLink(file + "  ", "DownloadFile", new { fileName = file, id = 2 })</p>
                                                // id 2 representation for certificate 2
                                            }
                                        </div>
                                        <div class="row-nowrap">
                                            <input class=""
                                               type="file"
                                               name="certificates2"
                                               placeholder="Chứng Chỉ"
                                               multiple="multiple"
                                               accept=".jpg, .jpeg, .png, .doc, .docx, .pdf" />
                                        </div>

                                        <hr />
                                        <div class="row-nowrap">
                                            <div class="col-sm-3">
                                                <h6 class="mb-0">Giới thiệu về môn gia sư</h6>
                                            </div>
                                            @Html.TextAreaFor(m => m.GioiThieuVeMonGiaSu2, new { htmlAttributes = new { @class = "ip-form", @required = "required", @id="GioiThieuVeMonGiaSu2", @name="GioiThieuVeMonGiaSu2" } })
                                        </div>
                                        <div class="message-error">
                                            <span asp-validation-for="GioiThieuVeMonGiaSu2" class="text-danger" style="color:red"></span>
                                        </div>
                                        <hr />
                                    }
                                    <div class="row">
                                        <div class="col-12 flex-right mb-4">
                                            <a href='javascript:history.go(-1)' class="btn btn-dark" style="margin-right:5px;">Hủy</a>
                                            <button type="submit" class="btn btn-success" onclick="Button1_Click">Lưu thay đổi</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>
    @section scripts {
        <script>
            var minDate, maxDate;

            // Custom filtering function which will search data in column four between two values
            $.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {
                let min = moment($('#min').val(), 'DD/MM/YYYY', true).isValid() ?
                    moment($('#min').val(), 'DD/MM/YYYY', true).unix() :
                    null;

                let max = moment($('#max').val(), 'DD/MM/YYYY').isValid() ?
                    moment($('#max').val(), 'DD/MM/YYYY', true).unix() :
                    null;
                var date = moment(data[1], 'DD/MM/YYYY', true).unix();

                if (
                    (min === null && max === null) ||
                    (min === null && date <= max) ||
                    (min <= date && max === null) ||
                    (min <= date && date <= max)
                ) {
                    return true;
                }
                return false;
            });

            $(document).ready(function () {
                // Create date inputs
                minDate = new DateTime($('#min'), {
                    format: 'DD/MM/YYYY',
                });
                maxDate = new DateTime($('#max'), {
                    format: 'DD/MM/YYYY',
                });

                // DataTables initialisation
                var table = $('#myTable').DataTable();

                // Refilter the table
                $('#min, #max').on('change', function () {
                    table.draw();
                });
            });
        </script>
        <script type="text/javascript">
            $(function () {
                $('#myTable_filter').prepend($('#dropdown-filter')).clone();
                $('#filter-fade').remove();
            })
        </script>
        @if (TempData["Message"] != null)
        {
            <script>
                var messageType = '@TempData["MessageType"]';
                var message = '@TempData["Message"]';

                // Display the message using Toastr library
                if (messageType === "success") {
                    toastr.success(message);
                } else if (messageType === "error") {
                    toastr.error(message);
                } else if (messageType === "warning") {
                    toastr.warning(message);
                } else if (messageType === "info") {
                    toastr.info(message);
                }
            </script>
        }
        @if (ViewBag.Message != null)
        {
            <script type="text/javascript">
                window.onload = function () {
                    alert("@ViewBag.Message");
                };
            </script>
        }
        <script src="~/js/app.js"></script>
        <script>
            $(function () {
                // Check for a success message in TempData
                var toastrSuccess = '@(TempData["toastr-success"])';
                if (toastrSuccess) {
                    toastr.success(toastrSuccess);
                }

                // Check for an error message in TempData
                var toastrError = '@(TempData["toastr-error"])';
                if (toastrError) {
                    toastr.error(toastrError);
                }
            });
        </script>
    }
    <!-- /.content -->
</div>